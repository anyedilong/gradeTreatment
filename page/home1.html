<!--院领导院医生首页 home1-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <script src="../js/page/commen.js"></script>
    <script src="../js/page/index.js"></script>
    <script src="../js/page/indexJump.js"></script>
    <style>
        .home-box, .circle_r {
            behavior: url(../js/PIE/PIE.htc);
            position: relative;
        }
        .home-box {
            background: #FFFFFF;
            border-radius: 4px;
            padding: 20px;
            box-sizing: border-box;
        }
        .left-dbsx {
            margin-bottom: 20px;
        }
        .circle_box li{
            float: left;
            width: 25%;
            text-align: center;
        }
        .circle_r{
            text-align: center;
            border-radius: 50%;
            font-size: 40px;
            margin-bottom: 20px;
            display: none;
        }
        .circle_tit {
            font-size: 14px;
        }
        .circle1{
            border: 4px solid #32B16C;
            color: #32B16C;
        }
        .circle2{
            border: 4px solid #3B76F6;
            color: #3B76F6;
        }
        .circle3{
            border: 4px solid #F39800;
            color: #F39800;
        }
        .circle4{
            border: 4px solid #FD6161;
            color: #FD6161;
        }
        .charts {
            width: 100%;
            height: 100%;
        }
        .right-jindu {
            padding-right: 0;
            overflow: hidden;
        }
        .right-ulBox {
            overflow-y: scroll;
            padding-right: 20px;
            box-sizing: border-box;
        }
        .jindu-ul {
            font-size: 14px;
        }
        .jindu-ul>li {
            margin-bottom: 20px;
        }
        .jinduI {
            width: 30px;
            line-height: 1.8em;
        }
        .jinduSpan {
            line-height: 1.5em;
        }
    </style>
</head>
<body>
    <div class="pageBox">
        <div class="layui-row layui-col-space20">
            <div class="layui-col-md8">
                <div class="home-box left-dbsx">
                    <div class="com-tit blueblack">待办事项</div>
                    <ul class="circle_box">
                        <li>
                            <a href="JavaScript:void(0)" >
                                <div class="circle_r circle1">
                                    <span id="zcsq"></span>
                                </div>
                                <div class="circle_tit">转出申请</div>
                            </a>
                        </li>
                        <li>
                            <a href="JavaScript:void(0)" >
                                <div class="circle_r circle2">
                                    <span id="hzsq"></span>
                                </div>
                                <div class="circle_tit">回转申请</div>
                            </a>
                        </li>
                        <li>
                            <a href="JavaScript:void(0)" >
                                <div class="circle_r circle3">
                                    <span id="zcjs"></span>
                                </div>
                                <div class="circle_tit">转入待接收</div>
                            </a>
                        </li>
                        <li>
                            <a href="JavaScript:void(0)" >
                                <div class="circle_r circle4">
                                    <span id="hzjs"></span>
                                </div>
                                <div class="circle_tit">回转待接收</div>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="home-box left-byzztj">
                    <div class="charts" id="linecharts"></div>
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="home-box right-jindu">
                    <div class="com-tit blueblack" id="rightTitle">审核进度</div>
                    <div class="right-ulBox">
                        <ul class="jindu-ul">
<!--                            <li>-->
<!--                                <i class="iconfont jinduI fl">&#xe62c;</i>-->
<!--                                <span class="fl jinduSpan fl">内科的张大夫提交了张木木的转出申请，正在等待你的审核内科的张大夫提交了张木木的转出申请，正在等待你的审核内科的张大夫提交了张木木的转出申请，正在等待你的审核内科的张大夫提交了张木木的转出申请，正在等待你的审核内科的张大夫提交了张木木的转出申请，正在等待你的审核内科的张大夫提交了张木木的转出申请，正在等待你的审核</span>-->
<!--                                <div class="clear"></div>-->
<!--                            </li>-->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    $(function () {
        var roleCode = localStorage.getItem('roleCode');
        if(roleCode == '002'){
            $('#rightTitle').html('转诊申请');
            $('.circle1').next().html('转出申请审核');
            $('.circle2').next().html('回转申请审核');
            $('.circle3').next().html('转出接收审核');
            $('.circle4').next().html('回转接收审核');
        }else if(roleCode == '003'){
            $('#rightTitle').html('审核进度');
        }
        function divResize () {
            $('.left-dbsx').css('height', $('.pageBox').height() * 0.4 + 'px');
            var cirWid = $('.left-dbsx').width() * 0.25 - 8 - 20;
            var cirHei = $('.pageBox').height() * 0.4 - 120;
            if (cirWid > cirHei) {
                if (cirHei > 168) {
                    $('.circle_r').css({
                        'height': '168px',
                        'width': '168px',
                        'line-height': '168px',
                        'display': 'inline-block'
                    });
                } else {
                    $('.circle_r').css({
                        'height': cirHei + 'px',
                        'width': cirHei + 'px',
                        'line-height': cirHei + 'px',
                        'display': 'inline-block'
                    });
                }
            } else {
                if (cirWid > 168) {
                    $('.circle_r').css({
                        'height': '168px',
                        'width': '168px',
                        'line-height': '168px',
                        'display': 'inline-block'
                    });
                } else {
                    $('.circle_r').css({
                        'height': cirWid + 'px',
                        'width': cirWid + 'px',
                        'line-height': cirWid + 'px',
                        'display': 'inline-block'
                    });
                }
            }
            $('.left-byzztj').css('height', $('.pageBox').height() * 0.6 - 30 + 'px');
            $('.right-jindu').css('height', $('.pageBox').height() - 10 + 'px');
            $('.right-ulBox').css({
                'height': $('.right-jindu').height() - 41 + 'px',
                'width': $('.right-jindu').width() + 25 + 'px',
            });
            $('.jinduSpan').css({
                'width': $('.right-ulBox').width() - 50 + 'px'
            });
            lineC.resize();
        };
        var chartColor = ['#2BC807', '#F7AA2A'];
        var legData = ['转出','回转'];
        var lineC = echarts.init(document.getElementById('linecharts'));
        getCharts();
        function getCharts(){
            getAjax('/home/statsHomeTurnAndRotray', {}, function (resultMsg) {
            // 曲线图
                var xdataline = resultMsg.data.xList;
                var lineinData = resultMsg.data.y1List;
                var linerotData = resultMsg.data.y2List;
                var lineser = [
                    {
                        name: legData[0],
                        data: lineinData,
                        type: 'line',
                        barWidth: 12,
                        smooth: true,
                        symbolSize: 0,
                        lineStyle: {
                            width: 3
                        }
                    },
                    {
                        name: legData[1],
                        data: linerotData,
                        type: 'line',
                        barWidth: 12,
                        smooth: true,
                        symbolSize: 0,
                        lineStyle: {
                            width: 3
                        }
                    },
                ];
                var lineCopt = chartOpt('本月转诊统计',xdataline, chartColor, legData, lineser, 'line');
                lineC.setOption(lineCopt);
            });

            function chartOpt(text, xData, colors, legendData, serData, type) {
                var opt = {
                    title: {
                        text: text,
                        x: 'left',
                        textStyle: {
                            fontSize: 16,
                            color: '#43464D',
                            fontWeight: 'normal'
                        }
                    },
                    xAxis: {
                        type: 'category',
                        data: xData,
                        axisLine: {
                            lineStyle: {
                                type: 'solid',
                                color: '#F2F6FA',
                                width: '1'//坐标线的宽度
                            }
                        },
                        axisLabel: {
                            textStyle: {
                                color: '#A3A8AE'
                            }
                        },
                    },
                    yAxis:  {
                        minInterval: 1,
                        type : 'value',
                        axisLine: {
                            lineStyle: {
                                type: 'solid',
                                color: 'none',//左边线的颜色
                                width: '1'//坐标线的宽度
                            }
                        },
                        axisLabel: {
                            textStyle: {
                                color: '#A3A8AE'
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                color: ['#E8EAED']
                            }
                        }
                    },
                    grid: {
                        left: '3%',
                        right: '0%',
                        bottom: '3%',
                        containLabel: true
                    },
                    color: colors,
                    legend: {
                        data: legendData,
                        x: 'center', y: 'top',
                        textStyle: {color: '#C0C3C7',fontSize: 12},
                        itemWidth: 12,
                        itemHeight: 12,
                        icon: 'roundRect',
                        itemGap: 50,
                    },
                    series: serData,
                    tooltip : {
                        trigger: 'axis',
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : type        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    }
                };
                return opt;
            }
            // 代办事项
            getAjax('/home/myToDo', {}, function (resultMsg) {
                $('#zcsq').html(resultMsg.data.turnOut);
                $('#hzsq').html(resultMsg.data.turnBack);
                $('#zcjs').html(resultMsg.data.turnInAcc);
                $('#hzjs').html(resultMsg.data.turnBackAcc);
            });
            // 审核进度
            getAjax('/home/getLatestNews', {}, function (resultMsg) {
                var dataList = resultMsg.data;
                if(dataList.length == 0){
                    $('.jindu-ul').html('暂无数据');
                }else{
                    var html = '';
                    $.each(dataList,function (i,item) {
                        html += '<li>';
                        html += '<i class="iconfont jinduI fl">&#xe62c;</i>';
                        html += '<span class="fl jinduSpan fl">'+item+'</span>';
                        html += '<div class="clear"></div>';
                        html += '</li>';
                    });
                    $('.jindu-ul').html(html);
                    var colors = ['#32B16C', '#3B76F6', '#F39800', '#FD6161'];
                    for (var i = 0; i < $('.jindu-ul .jinduI').length; i++) {
                        if ((i) % 4 == 0) {
                            $('.jinduI').eq(i).css('color', colors[0]);
                        } else if ((i - 1) % 4 == 0) {
                            $('.jinduI').eq(i).css('color', colors[1]);
                        } else if ((i - 2) % 4 == 0) {
                            $('.jinduI').eq(i).css('color', colors[2]);
                        } else if ((i - 3) % 4 == 0) {
                            $('.jinduI').eq(i).css('color', colors[3]);
                        }
                    }
                }

            });
        }
        $('.circle_box').on('click','a',function () {
            if($(this).parent('li').index() === 0){
                jumpGuanxi('转出申请','outTransfer.html');
            }else if($(this).parent('li').index() === 1){
                jumpGuanxi('回转转诊','rotaryTransfer.html');
            }if($(this).parent('li').index() === 2){
                jumpGuanxi('接收转入','acceptTransfer.html');
            }if($(this).parent('li').index() === 3){
                jumpGuanxi('回转列表','rotaryList.html');
            }
        });
        window.onload = divResize;
        window.onresize = divResize;
    });
</script>
</html>